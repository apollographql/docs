---
title: Contract overview
subtitle: Use contracts to deliver different subsets of your enterprise supergraph
description: GraphOS contracts allow you to deliver subsets of your federated graph to consumers using the @tag directive.
---

<EnterpriseFeature />

GraphOS **contracts** enable you to deliver different subsets of your supergraph to different consumers. Each contract filters specific portions of your supergraph's schema into a different GraphOS variant:

```mermaid
graph LR;
  subgraph "Source variant";
  api("Supergraph<br/>schema<br/>▉");
  end
  subgraph "Contract variant B"
  contractB("Contract schema B<br/>▟")
  end
  subgraph "Contract variant A"
  contractA("Contract schema A<br/>▛");
  end
  api -."Filter schema<br/>according to contract A".->contractA
  api -."Filter schema<br/>according to contract B".->contractB
```

A contract filters definitions from your subgraph schemas based on `@tag` directives that you add:

```graphql {4} title="Source variant subgraph schema"
type Product {
  id: ID!
  name: String!
  codename: String! @tag(name: "internal")
}
```

```graphql title="Contract variant API schema"
type Product {
  id: ID!
  name: String!
  # codename field is filtered out
}
```

In the above example, a contract excludes types and fields marked with the `internal` `@tag`.

## What are contracts for?

You usually create a contract to support a **contract router** or **contract documentation** (or both).

#### Contract routers

You can deploy a [managed instance](/federation/managed-federation/overview/) of your graph router that uses a contract schema. Clients that use a contract router's endpoint can only execute GraphQL operations that the contract schema supports:

```mermaid
graph BT;
  adminapp(Admin app);
  userapp(User app);
  subgraph " ";
    standardgateway(["Standard router<br/>▉"]);
    contractgateway(["Contract router<br/>▟"]);
    subgraphs[["(All subgraphs)"]];
  end;
  userapp -.- contractgateway;
  adminapp -.- standardgateway;
  standardgateway & contractgateway --- subgraphs;
  class adminapp,userapp secondary;
```

This enables you to hide experimental types and fields that are still in development, or to limit a particular audience's access to only the portions of your graph that they need.

Contract routers can safely connect to the same subgraph instances as any other router, because their clients can only interact with data that's represented in the contract schema. This does not affect internal routing (filtered fields can still be used in a `@requires` selection set).

<Note>

Any `@tag` present in a source variant's supergraph schema is _also_ present in a contract variant's supergraph schema.

</Note>

#### Contract documentation

In Studio, each contract variant has its own README, schema reference, and Explorer. If you [make a contract variant public](../graphs/studio-features/#public-variants), you can provide these resources to external client developers to help them interact with a specific portion of your graph (while omitting irrelevant types and fields).

## Federation 1 limitations

Contracts behave slightly differently depending on which version of Apollo Federation your graph uses (1 or 2). Most importantly, graphs that use Federation 1 _cannot_ use `@tag`s to exclude the following from a contract schema:

- Custom scalar types (default scalar types can _never_ be excluded)
- Enum types or their values
- Input types or their fields
- Arguments of object fields or interface fields

### Contracts and Federation 2

To create a contract variant that uses Federation 2, the contract's source variant must _also_ use Federation 2.
[Learn how to move an existing variant to Federation 2.](/federation/federation-2/moving-to-federation-2#step-2-configure-your-composition-method)

#### Moving an existing contract to Federation 2

If a Federation 1 source variant already has one or more associated contracts, it isn't possible to move that variant or its contract variants to Federation 2. Instead, you need to **delete and recreate** your contract variants with the following steps:

1. Identify the source variant you want to move to Federation 2.
2. Save the details for each of that source variant's existing contract variants (most importantly each variant's associated filters).
3. Delete all of the source variant's existing contract variants.
4. Now that the source variant has no associated contracts, you can configure it to use Federation 2 composition ([learn how](/federation/federation-2/moving-to-federation-2#step-2-configure-your-composition-method)).
5. Recreate your deleted contract variants, which will now use Federation 2 composition like the modified source variant.
